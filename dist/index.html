<style scoped>
.outerwrapper{width:100%;min-height:900px;position:relative;border:1px solid #c8c7cf}.outerwrapper h2,.outerwrapper h3,.outerwrapper p{padding:10px 10px 0;margin:0}
</style>
<div class="outerwrapper">
	<div class="chart"></div>

	<ul id="networkSelect">
		<li>
			<input type="checkbox" id="twitter" name="twitter" checked>
			<label for="twitter">Twitter</label>
		</li>
		<li>
			<input type="checkbox" id="facebook" name="facebook" checked>
			<label for="facebook">Facebook</label>
		</li>
		<li>
			<input type="checkbox" id="academiaedu" name="academiaedu" checked>
			<label for="academiaedu">Academia.edu</label>
		</li>
		<li>
			<input type="checkbox" id="researchGate" name="researchGate" checked>
			<label for="researchGate">ResearchGate</label>
		</li>
		<li>
			<input type="checkbox" id="linkedIn" name="linkedIn" checked>
			<label for="linkedIn">linkedIn</label>
		</li>
		<li>
			<input type="checkbox" id="mendeley" name="mendeley" checked>
			<label for="mendeley">Mendeley</label>
		</li>
	<ul>
</div>


<!--[if gt IE 8]><!-->
<script type="text/javascript">
function buildGraphic(dataSet) {
	/*  Colours for the bars */
	var colour = [
					"#00642D",
					"#95177E",
					"#F8B436",
					"#EB6B4B",
					"#3BAADC",
					"#96BE17"
				];

	var margin = {top: 20, right: 50, bottom: 20, left: 80};
	var width = 630 - margin.left - margin.right;
	var height = 630 - margin.top - margin.bottom;
	var baseRad = (Math.PI * 2) / dataSet[0].length;
	var baseAngle = 180 / dataSet[0].length;

	var networkSelect = jQuery('#networkSelect');

	var scaleLines = [0, 5,10,15,20,25,30,35];

	var radiusScale = d3.scale.linear()
						.domain([0,35])
						.range([0,width/2]);

	var mySvg = d3.select(".chart").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom);

	var myScale = mySvg.append("g")
		.attr("transform", "translate(" + (width + margin.left + margin.right) / 2 + "," + (height + margin.top + margin.bottom) / 2 + ")");

	myScale.selectAll('circle')
	  .data(scaleLines)
	  	.enter()
	  	.append('circle')
		.attr('cx', 0)
		.attr('cy', 0)
		.attr('r', function (d) {
			return radiusScale(d);
		})
		.attr('fill', 'none')
		.attr('stroke', '#666');

	var myTicks = mySvg.append("g")
		.attr("transform", "translate(" + (width + margin.left + margin.right) / 2 + "," + (height + margin.top + margin.bottom) / 2 + ")");

	myTicks.selectAll('text')
	  .data(scaleLines)
		.enter()
		.append('svg:text')
		.attr('y', function(d) { return -1 * radiusScale(d) })
		.attr("text-anchor", "middle")
		.attr("dy", ".35em")
		.text(function (d) {
			return d + "%";
		});

	var myGroup = mySvg.append("g")
		.attr("transform", "translate(" + (width + margin.left + margin.right) / 2 + "," + (height + margin.top + margin.bottom) / 2 + "), rotate(" + (baseAngle * -1) +")");
		
	  

	var myArc = d3.svg.arc();
		myArc.innerRadius(0);
		myArc.outerRadius(function (d) { return radiusScale(d) } );
		myArc.startAngle(function (d,i) { return baseRad * i } );
		myArc.endAngle(function (d,i) { return baseRad * (i + 1) });


	var arcs1 = myGroup.selectAll('.arc1')  
	  .data(dataSet[0])
		.enter();

	arcs1.append("path")
		.attr('d', myArc)
		.attr('fill', colour[0])
		.attr('stroke', '#fff')
		.attr('stroke-width', '1')
		.attr('opacity','0.5');

	var arcs2 = myGroup.selectAll('.arc2')  
	  .data(dataSet[1])
		.enter();

	arcs2.append("path")
		.attr('d', myArc)
		.attr('class', 'arc2')
		.attr('fill', colour[1])
		.attr('stroke', '#fff')
		.attr('stroke-width', '1')
		.attr('opacity','0.5');

	var arcs3 = myGroup.selectAll('.arc3')  
	  .data(dataSet[2])
		.enter();

	arcs3.append("path")
		.attr('d', myArc)
		.attr('fill', colour[2])
		.attr('stroke', '#fff')
		.attr('stroke-width', '1')
		.attr('opacity','0.5');

	var arcs4 = myGroup.selectAll('.arc4')  
	  .data(dataSet[3])
		.enter();

	arcs4.append("path")
		.attr('d', myArc)
		.attr('fill', colour[3])
		.attr('stroke', '#fff')
		.attr('stroke-width', '1')
		.attr('opacity','0.5');

	var arcs5 = myGroup.selectAll('.arc5')  
	  .data(dataSet[4])
		.enter();

	arcs5.append("path")
		.attr('d', myArc)
		.attr('fill', colour[4])
		.attr('stroke', '#fff')
		.attr('stroke-width', '1')
		.attr('opacity','0.5');

	var arcs6 = myGroup.selectAll('.arc6')  
	  .data(dataSet[5])
		.enter();

	arcs6.append("path")
		.attr('d', myArc)
		.attr('fill', colour[5])
		.attr('stroke', '#fff')
		.attr('stroke-width', '1')
		.attr('opacity','0.5');

	jQuery('#twitter').change(
		function () {
			if($(this).attr('checked')) {
				console.log("It's checked");
				myGroup.selectAll('path.arc2')
					.transition()
					.duration(200)
					.attr('opacity', '0.5');
			} else {
				console.log("It ain't checked");
				myGroup.selectAll('path.arc2')
					.transition()
					.duration(200)
					.attr('opacity', '0');
			}
			;
		}
	);

}






















(function() {
		var init = function($)
		{
		/*	==================================================================================== */
		/*	GLOBAL VARIABLES FOR D3 */



		/*	Margin, Width and height */
		var margin = {top: 15, right: 20, bottom: 20, left: 90};
		var width = $('.outerwrapper').width()  - margin.left - margin.right;
		var height = 350 - margin.top - margin.bottom;
		/*	Global variable to control the length of D3 transitons */
		var duration = 450;

		/*	==================================================================================== */
		/*	jQuery ready */

			/*	==================================================================================== */
			/*	Load D3 */
			/*	All of the D3/svg code is contained within the call back function */
			/*	Loading D3 into ie6-8 seems to cause a runtime error */
			$.getScript("http://www.nature.com/polopoly_static/js/d3.v3.min.js", function() {
				// buildObjects(); 
				
				// buildArrays();


				$.ajax({
					url: "data/table.html",
					// url: "https://poly-admin1.nature.com/preview/www/2.788/1.15117/7.18701",
					dataType: 'text',
					success: function (data) {

						var dataSet = [];

						// Store each row of the table in a var
						var tableRows = $(data).find("tbody tr");
						
						for (var i = 0; i < tableRows.length; i++) {
							
							dataSet.push(new Array);

							for (var p = 1; p < (tableRows.eq(i).find('td').length -1); p++) {
								dataSet[i].push(tableRows.eq(i).find('td').eq(p).text());
							};
						};
						buildGraphic(dataSet);
					}


				});

			}); // End of d3js getscript call 

		/* End of active code */
		};


	setTimeout(function()
	{
	if (typeof jQuery !== 'undefined')
	{
		init(jQuery);
	} else
	{
		setTimeout(arguments.callee, 60);
	}
	}, 60);

})();
</script>
<!--<![endif]-->